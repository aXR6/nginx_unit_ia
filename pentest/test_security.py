#!/usr/bin/env python3
"""Simula um ataque e verifica o registro no painel web."""
"""Teste b√°sico de envio de payload e registro de log."""

def test_security(client):
    payload = "<script>alert('ataque')</script>"
    client.get(f"/?data={payload}")
    logs = client.get("/api/logs").get_json()
    assert any(payload in entry.get("log", "") for entry in logs)
    blocked = client.get("/api/blocked").get_json()
    assert blocked == []
